{"ast":null,"code":"import _regeneratorRuntime from\"C:/Benkia/MERN/instagram-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"C:/Benkia/MERN/instagram-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"C:/Benkia/MERN/instagram-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Benkia/MERN/instagram-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef,useState}from\"react\";import PostThumb from\"../../components/PostProfile/PostThumb\";import LoadingIcon from\"../../assets/images/loading.gif\";import\"./index.scss\";import LoadMoreBtn from\"../../components/LoadMoreBtn\";import{getDataAPI}from\"../../utils/fetchData\";import{PROFILE_TYPES}from\"../../redux/types/profileTypes\";import{getMoreUserPosts}from\"../../redux/actions/profileActions\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var PostProfiles=function PostProfiles(_ref){var auth=_ref.auth,id=_ref.id,dispatch=_ref.dispatch,profile=_ref.profile;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState(9),_useState4=_slicedToArray(_useState3,2),result=_useState4[0],setResult=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),page=_useState6[0],setPage=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),load=_useState8[0],setLoad=_useState8[1];var pageEnd=useRef();useEffect(function(){profile.posts.forEach(function(data){if(data._id===id){setPosts(data.posts);setResult(data.result);setPage(data.page);}});},[profile.posts,id]);var handleLoadMore=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,newData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoad(true);_context.next=3;return getDataAPI(\"user_posts/\".concat(id,\"?limit=\").concat(page*9),auth.token);case 3:res=_context.sent;newData=_objectSpread(_objectSpread({},res.data),{},{page:page+1,_id:id});dispatch({type:PROFILE_TYPES.UPDATE_POST,payload:newData});setLoad(false);case 7:case\"end\":return _context.stop();}}},_callee);}));return function handleLoadMore(){return _ref2.apply(this,arguments);};}();//Loadmore\n// useEffect(() => {\n//   const observer = new IntersectionObserver(\n//     (entries) => {\n//       if (entries[0].isIntersecting) {\n//         setPage((p) => p + 1);\n//       }\n//     },\n//     {\n//       threshold: 0.1,\n//     }\n//   );\n//   observer.observe(pageEnd.current);\n// }, [setPage]);\n// useEffect(() => {\n//   if (result >= 9 * (page - 1) && page > 1) {\n//     setLoad(true);\n//     dispatch(getMoreUserPosts({ id, page, auth }));\n//     setLoad(false);\n//   } else {\n//     return;\n//   }\n// }, [auth, dispatch, result, page, id]);\nreturn/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"post-profile-container\",children:[/*#__PURE__*/_jsx(PostThumb,{posts:posts,result:result}),load&&/*#__PURE__*/_jsx(\"div\",{className:\"post-profile-loading\",children:/*#__PURE__*/_jsx(\"img\",{src:LoadingIcon,alt:\"Logo\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"post-profile-btn\",children:/*#__PURE__*/_jsx(LoadMoreBtn,{result:result,page:page,load:load,handleLoadMore:handleLoadMore})})]})});};export default PostProfiles;","map":{"version":3,"sources":["C:/Benkia/MERN/instagram-clone/client/src/layouts/PostProfiles/index.js"],"names":["React","useEffect","useRef","useState","PostThumb","LoadingIcon","LoadMoreBtn","getDataAPI","PROFILE_TYPES","getMoreUserPosts","PostProfiles","auth","id","dispatch","profile","posts","setPosts","result","setResult","page","setPage","load","setLoad","pageEnd","forEach","data","_id","handleLoadMore","token","res","newData","type","UPDATE_POST","payload"],"mappings":"4mBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,MAA3B,CAAmCC,QAAnC,KAAmD,OAAnD,CACA,MAAOC,CAAAA,SAAP,KAAsB,wCAAtB,CACA,MAAOC,CAAAA,WAAP,KAAwB,iCAAxB,CACA,MAAO,cAAP,CACA,MAAOC,CAAAA,WAAP,KAAwB,8BAAxB,CACA,OAASC,UAAT,KAA2B,uBAA3B,CACA,OAASC,aAAT,KAA8B,gCAA9B,CACA,OAASC,gBAAT,KAAiC,oCAAjC,C,6IACA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,MAAqC,IAAlCC,CAAAA,IAAkC,MAAlCA,IAAkC,CAA5BC,EAA4B,MAA5BA,EAA4B,CAAxBC,QAAwB,MAAxBA,QAAwB,CAAdC,OAAc,MAAdA,OAAc,CACxD,cAA0BX,QAAQ,CAAC,EAAD,CAAlC,wCAAOY,KAAP,eAAcC,QAAd,eACA,eAA4Bb,QAAQ,CAAC,CAAD,CAApC,yCAAOc,MAAP,eAAeC,SAAf,eACA,eAAwBf,QAAQ,CAAC,CAAD,CAAhC,yCAAOgB,IAAP,eAAaC,OAAb,eACA,eAAwBjB,QAAQ,CAAC,KAAD,CAAhC,yCAAOkB,IAAP,eAAaC,OAAb,eACA,GAAMC,CAAAA,OAAO,CAAGrB,MAAM,EAAtB,CAEAD,SAAS,CAAC,UAAM,CACda,OAAO,CAACC,KAAR,CAAcS,OAAd,CAAsB,SAACC,IAAD,CAAU,CAC9B,GAAIA,IAAI,CAACC,GAAL,GAAad,EAAjB,CAAqB,CACnBI,QAAQ,CAACS,IAAI,CAACV,KAAN,CAAR,CACAG,SAAS,CAACO,IAAI,CAACR,MAAN,CAAT,CACAG,OAAO,CAACK,IAAI,CAACN,IAAN,CAAP,CACD,CACF,CAND,EAOD,CARQ,CAQN,CAACL,OAAO,CAACC,KAAT,CAAgBH,EAAhB,CARM,CAAT,CAUA,GAAMe,CAAAA,cAAc,2FAAG,mJACrBL,OAAO,CAAC,IAAD,CAAP,CADqB,sBAEHf,CAAAA,UAAU,sBACZK,EADY,mBACAO,IAAI,CAAG,CADP,EAE1BR,IAAI,CAACiB,KAFqB,CAFP,QAEfC,GAFe,eAMfC,OANe,gCAMAD,GAAG,CAACJ,IANJ,MAMUN,IAAI,CAAEA,IAAI,CAAG,CANvB,CAM0BO,GAAG,CAAEd,EAN/B,GAOrBC,QAAQ,CAAC,CACPkB,IAAI,CAAEvB,aAAa,CAACwB,WADb,CAEPC,OAAO,CAAEH,OAFF,CAAD,CAAR,CAIAR,OAAO,CAAC,KAAD,CAAP,CAXqB,sDAAH,kBAAdK,CAAAA,cAAc,2CAApB,CAcA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,mBACE,sCACE,aAAK,SAAS,CAAC,wBAAf,wBACE,KAAC,SAAD,EAAW,KAAK,CAAEZ,KAAlB,CAAyB,MAAM,CAAEE,MAAjC,EADF,CAEGI,IAAI,eACH,YAAK,SAAS,CAAC,sBAAf,uBACE,YAAK,GAAG,CAAEhB,WAAV,CAAuB,GAAG,CAAC,MAA3B,EADF,EAHJ,cAUE,YAAK,SAAS,CAAC,kBAAf,uBACE,KAAC,WAAD,EACE,MAAM,CAAEY,MADV,CAEE,IAAI,CAAEE,IAFR,CAGE,IAAI,CAAEE,IAHR,CAIE,cAAc,CAAEM,cAJlB,EADF,EAVF,GADF,EADF,CAuBD,CAjFD,CAmFA,cAAejB,CAAAA,YAAf","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\r\nimport PostThumb from \"../../components/PostProfile/PostThumb\";\r\nimport LoadingIcon from \"../../assets/images/loading.gif\";\r\nimport \"./index.scss\";\r\nimport LoadMoreBtn from \"../../components/LoadMoreBtn\";\r\nimport { getDataAPI } from \"../../utils/fetchData\";\r\nimport { PROFILE_TYPES } from \"../../redux/types/profileTypes\";\r\nimport { getMoreUserPosts } from \"../../redux/actions/profileActions\";\r\nconst PostProfiles = ({ auth, id, dispatch, profile }) => {\r\n  const [posts, setPosts] = useState([]);\r\n  const [result, setResult] = useState(9);\r\n  const [page, setPage] = useState(0);\r\n  const [load, setLoad] = useState(false);\r\n  const pageEnd = useRef();\r\n\r\n  useEffect(() => {\r\n    profile.posts.forEach((data) => {\r\n      if (data._id === id) {\r\n        setPosts(data.posts);\r\n        setResult(data.result);\r\n        setPage(data.page);\r\n      }\r\n    });\r\n  }, [profile.posts, id]);\r\n\r\n  const handleLoadMore = async () => {\r\n    setLoad(true);\r\n    const res = await getDataAPI(\r\n      `user_posts/${id}?limit=${page * 9}`,\r\n      auth.token\r\n    );\r\n    const newData = { ...res.data, page: page + 1, _id: id };\r\n    dispatch({\r\n      type: PROFILE_TYPES.UPDATE_POST,\r\n      payload: newData,\r\n    });\r\n    setLoad(false);\r\n  };\r\n\r\n  //Loadmore\r\n\r\n  // useEffect(() => {\r\n  //   const observer = new IntersectionObserver(\r\n  //     (entries) => {\r\n  //       if (entries[0].isIntersecting) {\r\n  //         setPage((p) => p + 1);\r\n  //       }\r\n  //     },\r\n  //     {\r\n  //       threshold: 0.1,\r\n  //     }\r\n  //   );\r\n\r\n  //   observer.observe(pageEnd.current);\r\n  // }, [setPage]);\r\n\r\n  // useEffect(() => {\r\n  //   if (result >= 9 * (page - 1) && page > 1) {\r\n  //     setLoad(true);\r\n  //     dispatch(getMoreUserPosts({ id, page, auth }));\r\n  //     setLoad(false);\r\n  //   } else {\r\n  //     return;\r\n  //   }\r\n  // }, [auth, dispatch, result, page, id]);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"post-profile-container\">\r\n        <PostThumb posts={posts} result={result} />\r\n        {load && (\r\n          <div className=\"post-profile-loading\">\r\n            <img src={LoadingIcon} alt=\"Logo\" />\r\n          </div>\r\n        )}\r\n        {/* <button className=\"post-profile-loadMore\" ref={pageEnd}>\r\n          Loadmore\r\n        </button> */}\r\n        <div className=\"post-profile-btn\">\r\n          <LoadMoreBtn\r\n            result={result}\r\n            page={page}\r\n            load={load}\r\n            handleLoadMore={handleLoadMore}\r\n          />\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PostProfiles;\r\n"]},"metadata":{},"sourceType":"module"}