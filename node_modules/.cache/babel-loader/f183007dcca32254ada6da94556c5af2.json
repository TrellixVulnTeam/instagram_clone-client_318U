{"ast":null,"code":"import _regeneratorRuntime from\"C:/Benkia/MERN/instagram-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Benkia/MERN/instagram-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import axios from\"axios\";import{postDataAPI}from\"../../utils/fetchData\";import{validForm}from\"../../utils/validForm\";import{AUTH_TYPES}from\"../types/authTypes\";import{NOTIFY_TYPES}from\"../types/notifyTypes\";export var loginAction=function loginAction(data){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{loading:true}});_context.next=4;return postDataAPI(\"login\",data);case 4:res=_context.sent;dispatch({type:AUTH_TYPES.AUTH,payload:{token:res.data.accessToken,user:res.data.user}});localStorage.setItem(\"firstLogin\",true);dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{success:res.data.msg}});_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:_context.t0.response.data.msg}});case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var refreshToken=function refreshToken(){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var firstLogin,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:firstLogin=localStorage.getItem(\"firstLogin\");if(!firstLogin){_context2.next=14;break;}dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{loading:true}});_context2.prev=3;_context2.next=6;return postDataAPI(\"refresh_token\");case 6:res=_context2.sent;dispatch({type:AUTH_TYPES.AUTH,payload:{token:res.data.accessToken,user:res.data.user}});dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{}});_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](3);dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:_context2.t0.response.data.msg}});case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[3,11]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var registerAction=function registerAction(_ref3){var userData=_ref3.userData,history=_ref3.history;return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var check,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:check=validForm(userData);if(!(check.errLength>0)){_context3.next=3;break;}return _context3.abrupt(\"return\",dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:check.errMsg.email||check.errMsg.fullname||check.errMsg.password||check.errMsg.username}}));case 3:_context3.prev=3;dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{loading:true}});_context3.next=7;return postDataAPI(\"register\",userData);case 7:res=_context3.sent;dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{success:res.data.msg}});history.push(\"/\");_context3.next=15;break;case 12:_context3.prev=12;_context3.t0=_context3[\"catch\"](3);dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:_context3.t0.response.data.msg}});case 15:case\"end\":return _context3.stop();}}},_callee3,null,[[3,12]]);}));return function(_x3){return _ref4.apply(this,arguments);};}();};export var logoutAction=function logoutAction(){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;localStorage.removeItem(\"firstLogin\");_context4.next=4;return postDataAPI(\"logout\");case 4:window.location.href=\"/\";_context4.next=10;break;case 7:_context4.prev=7;_context4.t0=_context4[\"catch\"](0);dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:_context4.t0.response.data.msg}});case 10:case\"end\":return _context4.stop();}}},_callee4,null,[[0,7]]);}));return function(_x4){return _ref5.apply(this,arguments);};}();};export var forgotPasswordAction=function forgotPasswordAction(email){return/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch){var res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return postDataAPI(\"forgot\",{email:email});case 3:res=_context5.sent;dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{success:res.data.msg}});_context5.next=10;break;case 7:_context5.prev=7;_context5.t0=_context5[\"catch\"](0);dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:_context5.t0.response.data.msg}});case 10:case\"end\":return _context5.stop();}}},_callee5,null,[[0,7]]);}));return function(_x5){return _ref6.apply(this,arguments);};}();};export var resetPasswordAction=function resetPasswordAction(_ref7){var password=_ref7.password,token=_ref7.token,history=_ref7.history;return/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(dispatch){var res;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return postDataAPI(\"resetPassword\",{password:password},token);case 3:res=_context6.sent;dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{success:res.data.msg}});history.push(\"/\");_context6.next=11;break;case 8:_context6.prev=8;_context6.t0=_context6[\"catch\"](0);dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:_context6.t0.response.data.msg}});case 11:case\"end\":return _context6.stop();}}},_callee6,null,[[0,8]]);}));return function(_x6){return _ref8.apply(this,arguments);};}();};","map":{"version":3,"sources":["C:/Benkia/MERN/instagram-clone/client/src/redux/actions/authActions.js"],"names":["axios","postDataAPI","validForm","AUTH_TYPES","NOTIFY_TYPES","loginAction","data","dispatch","type","NOTIFY","payload","loading","res","AUTH","token","accessToken","user","localStorage","setItem","success","msg","error","response","refreshToken","firstLogin","getItem","registerAction","userData","history","check","errLength","errMsg","email","fullname","password","username","push","logoutAction","removeItem","window","location","href","forgotPasswordAction","resetPasswordAction"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport { postDataAPI } from \"../../utils/fetchData\";\r\nimport { validForm } from \"../../utils/validForm\";\r\nimport { AUTH_TYPES } from \"../types/authTypes\";\r\nimport { NOTIFY_TYPES } from \"../types/notifyTypes\";\r\n\r\nexport const loginAction = (data) => {\r\n  return async (dispatch) => {\r\n    try {\r\n      dispatch({ type: NOTIFY_TYPES.NOTIFY, payload: { loading: true } });\r\n      const res = await postDataAPI(\"login\", data);\r\n      dispatch({\r\n        type: AUTH_TYPES.AUTH,\r\n        payload: { token: res.data.accessToken, user: res.data.user },\r\n      });\r\n      localStorage.setItem(\"firstLogin\", true);\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { success: res.data.msg },\r\n      });\r\n    } catch (err) {\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: err.response.data.msg },\r\n      });\r\n    }\r\n  };\r\n};\r\n\r\nexport const refreshToken = () => {\r\n  return async (dispatch) => {\r\n    const firstLogin = localStorage.getItem(\"firstLogin\");\r\n    if (firstLogin) {\r\n      dispatch({ type: NOTIFY_TYPES.NOTIFY, payload: { loading: true } });\r\n      try {\r\n        const res = await postDataAPI(\"refresh_token\");\r\n        dispatch({\r\n          type: AUTH_TYPES.AUTH,\r\n          payload: { token: res.data.accessToken, user: res.data.user },\r\n        });\r\n        dispatch({ type: NOTIFY_TYPES.NOTIFY, payload: {} });\r\n      } catch (err) {\r\n        dispatch({\r\n          type: NOTIFY_TYPES.NOTIFY,\r\n          payload: { error: err.response.data.msg },\r\n        });\r\n      }\r\n    }\r\n  };\r\n};\r\n\r\nexport const registerAction = ({ userData, history }) => {\r\n  return async (dispatch) => {\r\n    const check = validForm(userData);\r\n    if (check.errLength > 0)\r\n      return dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: {\r\n          error:\r\n            check.errMsg.email ||\r\n            check.errMsg.fullname ||\r\n            check.errMsg.password ||\r\n            check.errMsg.username,\r\n        },\r\n      });\r\n    try {\r\n      dispatch({ type: NOTIFY_TYPES.NOTIFY, payload: { loading: true } });\r\n      const res = await postDataAPI(\"register\", userData);\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { success: res.data.msg },\r\n      });\r\n      history.push(\"/\");\r\n    } catch (err) {\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: err.response.data.msg },\r\n      });\r\n    }\r\n  };\r\n};\r\n\r\nexport const logoutAction = () => {\r\n  return async (dispatch) => {\r\n    try {\r\n      localStorage.removeItem(\"firstLogin\");\r\n\r\n      await postDataAPI(\"logout\");\r\n      window.location.href = \"/\";\r\n    } catch (err) {\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: err.response.data.msg },\r\n      });\r\n    }\r\n  };\r\n};\r\n\r\nexport const forgotPasswordAction = (email) => {\r\n  return async (dispatch) => {\r\n    try {\r\n      const res = await postDataAPI(\"forgot\", { email });\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { success: res.data.msg },\r\n      });\r\n    } catch (err) {\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: err.response.data.msg },\r\n      });\r\n    }\r\n  };\r\n};\r\n\r\nexport const resetPasswordAction = ({ password, token, history }) => {\r\n  return async (dispatch) => {\r\n    try {\r\n      const res = await postDataAPI(\"resetPassword\", { password }, token);\r\n\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { success: res.data.msg },\r\n      });\r\n      history.push(\"/\");\r\n    } catch (err) {\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: err.response.data.msg },\r\n      });\r\n    }\r\n  };\r\n};\r\n"]},"metadata":{},"sourceType":"module"}