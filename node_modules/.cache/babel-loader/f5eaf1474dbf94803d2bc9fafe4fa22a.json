{"ast":null,"code":"import _toConsumableArray from\"C:/Benkia/MERN/instagram-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Benkia/MERN/instagram-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{createPostAction,updatePostAction}from\"../../../redux/actions/postActions\";import{NOTIFY_TYPES}from\"../../../redux/types/notifyTypes\";import{STATUS_TYPES}from\"../../../redux/types/statusTypes\";import{imageShow,videoShow}from\"../../../utils/mediaShow\";import Icons from\"../../Icons\";import\"./index.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var StatusModal=function StatusModal(){var _useSelector=useSelector(function(state){return state;}),auth=_useSelector.auth,status=_useSelector.status,socket=_useSelector.socket;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),content=_useState2[0],setContent=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),images=_useState4[0],setImages=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),stream=_useState6[0],setStream=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),tracks=_useState8[0],setTracks=_useState8[1];var dispatch=useDispatch();var videoRef=useRef();var refCanvas=useRef();useEffect(function(){if(status.onEdit){setContent(status.content);setImages(status.images);}},[status]);var handleChangeImage=function handleChangeImage(e){var files=_toConsumableArray(e.target.files);var err=\"\";var newImages=[];files.forEach(function(file){if(!file)return err=\"File does not exist.\";if(file.size>1024*1024*5){return err=\"This image/video larget is 5mb\";}return newImages.push(file);});if(err)dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:err}});setImages([].concat(_toConsumableArray(images),newImages));};var deleteImages=function deleteImages(index){var newArr=_toConsumableArray(images);newArr.splice(index,1);setImages(newArr);};var handleStream=function handleStream(){setStream(true);if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){navigator.mediaDevices.getUserMedia({video:true}).then(function(mediaStream){videoRef.current.srcObject=mediaStream;videoRef.current.play();var track=mediaStream.getTracks();setTracks(track[0]);}).catch(function(err){console.log(err.message);});}};var handleCapture=function handleCapture(){var width=videoRef.current.clientWidth;var height=videoRef.current.clientHeight;refCanvas.current.setAttribute(\"width\",width);refCanvas.current.setAttribute(\"height\",height);var ctx=refCanvas.current.getContext(\"2d\");ctx.drawImage(videoRef.current,0,0,width,height);var URL=refCanvas.current.toDataURL();setImages([].concat(_toConsumableArray(images),[{camera:URL}]));};var handleStopStream=function handleStopStream(){tracks.stop();setStream(false);};var handleSubmit=function handleSubmit(e){e.preventDefault();if(images.length===0)return dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:\"Please add your photos!\"}});if(status.onEdit){dispatch(updatePostAction({content:content,images:images,auth:auth,status:status}));}else{dispatch(createPostAction({content:content,images:images,auth:auth,socket:socket}));}setContent(\"\");setImages([]);if(tracks)tracks.stop();dispatch({type:STATUS_TYPES.STATUS,payload:false});};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"status-modal\",children:/*#__PURE__*/_jsxs(\"form\",{action:\"#\",className:\"status-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"status-heading\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Create New Post\"}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return dispatch({type:STATUS_TYPES.STATUS,payload:false});},children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"status-content\",children:[/*#__PURE__*/_jsx(\"textarea\",{name:\"content\",placeholder:\"\".concat(auth.user.username,\", what are you thinking ?\"),value:content,onChange:function onChange(e){return setContent(e.target.value);}}),/*#__PURE__*/_jsx(\"div\",{className:\"status-content-icons\",children:/*#__PURE__*/_jsx(Icons,{setContent:setContent,content:content})}),/*#__PURE__*/_jsx(\"div\",{className:\"status-content-showImg\",children:images.map(function(img,index){return/*#__PURE__*/_jsxs(\"div\",{id:\"file_img\",children:[img.camera?imageShow(img.camera):img.url?/*#__PURE__*/_jsx(_Fragment,{children:img.url.match(/video/i)?videoShow(img.url):imageShow(img.url)}):/*#__PURE__*/_jsx(_Fragment,{children:img.type.match(/video/i)?videoShow(URL.createObjectURL(img)):imageShow(URL.createObjectURL(img))}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return deleteImages(index);},children:\"\\xD7\"})]},index);})}),stream&&/*#__PURE__*/_jsxs(\"div\",{className:\"status-content-stream\",children:[/*#__PURE__*/_jsx(\"video\",{autoPlay:true,muted:true,ref:videoRef,width:\"100%\",height:\"100%\"}),/*#__PURE__*/_jsx(\"span\",{onClick:handleStopStream,children:\"\\xD7\"}),/*#__PURE__*/_jsx(\"canvas\",{ref:refCanvas,style:{display:\"none\"}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"status-content-images\",children:stream?/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-camera\",onClick:handleCapture}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-camera\",onClick:handleStream}),/*#__PURE__*/_jsxs(\"div\",{className:\"status-content-upload\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-image\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"file\",id:\"file\",multiple:true,accept:\"image/*,video/*\",onChange:handleChangeImage})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"status-footer\",children:/*#__PURE__*/_jsx(\"button\",{className:\"status-footer-btn\",type:\"submit\",children:\"Post\"})})]})]})})});};export default StatusModal;","map":{"version":3,"sources":["C:/Benkia/MERN/instagram-clone/client/src/components/Status/StatusModal/index.js"],"names":["React","useEffect","useRef","useState","useDispatch","useSelector","createPostAction","updatePostAction","NOTIFY_TYPES","STATUS_TYPES","imageShow","videoShow","Icons","StatusModal","state","auth","status","socket","content","setContent","images","setImages","stream","setStream","tracks","setTracks","dispatch","videoRef","refCanvas","onEdit","handleChangeImage","e","files","target","err","newImages","forEach","file","size","push","type","NOTIFY","payload","error","deleteImages","index","newArr","splice","handleStream","navigator","mediaDevices","getUserMedia","video","then","mediaStream","current","srcObject","play","track","getTracks","catch","console","log","message","handleCapture","width","clientWidth","height","clientHeight","setAttribute","ctx","getContext","drawImage","URL","toDataURL","camera","handleStopStream","stop","handleSubmit","preventDefault","length","STATUS","user","username","value","map","img","url","match","createObjectURL","display"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  createPostAction,\r\n  updatePostAction,\r\n} from \"../../../redux/actions/postActions\";\r\nimport { NOTIFY_TYPES } from \"../../../redux/types/notifyTypes\";\r\nimport { STATUS_TYPES } from \"../../../redux/types/statusTypes\";\r\nimport { imageShow, videoShow } from \"../../../utils/mediaShow\";\r\nimport Icons from \"../../Icons\";\r\nimport \"./index.scss\";\r\nconst StatusModal = () => {\r\n  const { auth, status, socket } = useSelector((state) => state);\r\n  const [content, setContent] = useState(\"\");\r\n  const [images, setImages] = useState([]);\r\n  const [stream, setStream] = useState(false);\r\n  const [tracks, setTracks] = useState(\"\");\r\n  const dispatch = useDispatch();\r\n  const videoRef = useRef();\r\n  const refCanvas = useRef();\r\n\r\n  useEffect(() => {\r\n    if (status.onEdit) {\r\n      setContent(status.content);\r\n      setImages(status.images);\r\n    }\r\n  }, [status]);\r\n\r\n  const handleChangeImage = (e) => {\r\n    const files = [...e.target.files];\r\n    let err = \"\";\r\n    let newImages = [];\r\n    files.forEach((file) => {\r\n      if (!file) return (err = \"File does not exist.\");\r\n\r\n      if (file.size > 1024 * 1024 * 5) {\r\n        return (err = \"This image/video larget is 5mb\");\r\n      }\r\n\r\n      return newImages.push(file);\r\n    });\r\n\r\n    if (err)\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: err },\r\n      });\r\n    setImages([...images, ...newImages]);\r\n  };\r\n\r\n  const deleteImages = (index) => {\r\n    const newArr = [...images];\r\n    newArr.splice(index, 1);\r\n    setImages(newArr);\r\n  };\r\n\r\n  const handleStream = () => {\r\n    setStream(true);\r\n    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\r\n      navigator.mediaDevices\r\n        .getUserMedia({ video: true })\r\n        .then((mediaStream) => {\r\n          videoRef.current.srcObject = mediaStream;\r\n          videoRef.current.play();\r\n          const track = mediaStream.getTracks();\r\n          setTracks(track[0]);\r\n        })\r\n        .catch((err) => {\r\n          console.log(err.message);\r\n        });\r\n    }\r\n  };\r\n\r\n  const handleCapture = () => {\r\n    const width = videoRef.current.clientWidth;\r\n    const height = videoRef.current.clientHeight;\r\n\r\n    refCanvas.current.setAttribute(\"width\", width);\r\n    refCanvas.current.setAttribute(\"height\", height);\r\n\r\n    const ctx = refCanvas.current.getContext(\"2d\");\r\n    ctx.drawImage(videoRef.current, 0, 0, width, height);\r\n    let URL = refCanvas.current.toDataURL();\r\n\r\n    setImages([...images, { camera: URL }]);\r\n  };\r\n\r\n  const handleStopStream = () => {\r\n    tracks.stop();\r\n    setStream(false);\r\n  };\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    if (images.length === 0)\r\n      return dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: \"Please add your photos!\" },\r\n      });\r\n\r\n    if (status.onEdit) {\r\n      dispatch(updatePostAction({ content, images, auth, status }));\r\n    } else {\r\n      dispatch(createPostAction({ content, images, auth, socket }));\r\n    }\r\n\r\n    setContent(\"\");\r\n    setImages([]);\r\n    if (tracks) tracks.stop();\r\n    dispatch({\r\n      type: STATUS_TYPES.STATUS,\r\n      payload: false,\r\n    });\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div className=\"status-modal\">\r\n        <form action=\"#\" className=\"status-form\" onSubmit={handleSubmit}>\r\n          <div className=\"status-heading\">\r\n            <h5>Create New Post</h5>\r\n            <span\r\n              onClick={() =>\r\n                dispatch({\r\n                  type: STATUS_TYPES.STATUS,\r\n                  payload: false,\r\n                })\r\n              }\r\n            >\r\n              &times;\r\n            </span>\r\n          </div>\r\n\r\n          <div className=\"status-content\">\r\n            <textarea\r\n              name=\"content\"\r\n              placeholder={`${auth.user.username}, what are you thinking ?`}\r\n              value={content}\r\n              onChange={(e) => setContent(e.target.value)}\r\n            />\r\n\r\n            <div className=\"status-content-icons\">\r\n              <Icons setContent={setContent} content={content} />\r\n            </div>\r\n\r\n            <div className=\"status-content-showImg\">\r\n              {images.map((img, index) => (\r\n                <div key={index} id=\"file_img\">\r\n                  {img.camera ? (\r\n                    imageShow(img.camera)\r\n                  ) : img.url ? (\r\n                    <>\r\n                      {img.url.match(/video/i)\r\n                        ? videoShow(img.url)\r\n                        : imageShow(img.url)}\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      {img.type.match(/video/i)\r\n                        ? videoShow(URL.createObjectURL(img))\r\n                        : imageShow(URL.createObjectURL(img))}\r\n                    </>\r\n                  )}\r\n                  <span onClick={() => deleteImages(index)}>&times;</span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n\r\n            {stream && (\r\n              <div className=\"status-content-stream\">\r\n                <video\r\n                  autoPlay\r\n                  muted\r\n                  ref={videoRef}\r\n                  width=\"100%\"\r\n                  height=\"100%\"\r\n                />\r\n                <span onClick={handleStopStream}>&times;</span>\r\n                <canvas ref={refCanvas} style={{ display: \"none\" }} />\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"status-content-images\">\r\n              {stream ? (\r\n                <i className=\"fas fa-camera\" onClick={handleCapture} />\r\n              ) : (\r\n                <>\r\n                  <i className=\"fas fa-camera\" onClick={handleStream} />\r\n                  <div className=\"status-content-upload\">\r\n                    <i className=\"fas fa-image\" />\r\n                    <input\r\n                      type=\"file\"\r\n                      name=\"file\"\r\n                      id=\"file\"\r\n                      multiple\r\n                      accept=\"image/*,video/*\"\r\n                      onChange={handleChangeImage}\r\n                    />\r\n                  </div>\r\n                </>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"status-footer\">\r\n              <button className=\"status-footer-btn\" type=\"submit\">\r\n                Post\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default StatusModal;\r\n"]},"metadata":{},"sourceType":"module"}