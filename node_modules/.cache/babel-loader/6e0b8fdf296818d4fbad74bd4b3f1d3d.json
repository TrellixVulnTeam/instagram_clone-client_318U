{"ast":null,"code":"import { getDataAPI, postDataAPI } from \"../../utils/fetchData\";\nimport { MESSAGE_TYPES } from \"../types/messageTypes\";\nimport { NOTIFY_TYPES } from \"../types/notifyTypes\";\nexport const addUserAction = ({\n  user,\n  message\n}) => {\n  return async dispatch => {\n    if (message.users.every(item => item._id !== user._id)) {\n      dispatch({\n        type: MESSAGE_TYPES.ADD_USER,\n        payload: user\n      });\n    }\n  };\n};\nexport const addMessageAction = ({\n  msg,\n  auth,\n  socket\n}) => {\n  return async dispatch => {\n    dispatch({\n      type: MESSAGE_TYPES.ADD_MESSAGE,\n      payload: msg\n    });\n\n    try {\n      await postDataAPI(\"message\", msg, auth.token);\n    } catch (err) {\n      dispatch({\n        type: NOTIFY_TYPES.NOTIFY,\n        payload: {\n          error: err.response.data.msg\n        }\n      });\n    }\n  };\n};\nexport const getConversations = ({\n  auth\n}) => {\n  return async dispatch => {\n    try {\n      const res = await getDataAPI(\"conversations\", auth.token);\n      let newArr = [];\n      res.data.conversations.forEach(item => {\n        item.recipients.forEach(cv => {\n          if (cv._id === auth.user._id) {\n            newArr.push({ ...cv,\n              text: item.text,\n              media: item.media\n            });\n          }\n        });\n      });\n      dispatch({\n        type: MESSAGE_TYPES.GET_CONVERSATIONS,\n        payload: {\n          newArr,\n          result: res.data.result\n        }\n      });\n    } catch (err) {\n      dispatch({\n        type: NOTIFY_TYPES.NOTIFY,\n        payload: {\n          error: err.response.data.msg\n        }\n      });\n    }\n  };\n};","map":{"version":3,"sources":["C:/Benkia/MERN/instagram-clone/client/src/redux/actions/messageActions.js"],"names":["getDataAPI","postDataAPI","MESSAGE_TYPES","NOTIFY_TYPES","addUserAction","user","message","dispatch","users","every","item","_id","type","ADD_USER","payload","addMessageAction","msg","auth","socket","ADD_MESSAGE","token","err","NOTIFY","error","response","data","getConversations","res","newArr","conversations","forEach","recipients","cv","push","text","media","GET_CONVERSATIONS","result"],"mappings":"AAAA,SAASA,UAAT,EAAqBC,WAArB,QAAwC,uBAAxC;AACA,SAASC,aAAT,QAA8B,uBAA9B;AACA,SAASC,YAAT,QAA6B,sBAA7B;AAEA,OAAO,MAAMC,aAAa,GAAG,CAAC;AAAEC,EAAAA,IAAF;AAAQC,EAAAA;AAAR,CAAD,KAAuB;AAClD,SAAO,MAAOC,QAAP,IAAoB;AACzB,QAAID,OAAO,CAACE,KAAR,CAAcC,KAAd,CAAqBC,IAAD,IAAUA,IAAI,CAACC,GAAL,KAAaN,IAAI,CAACM,GAAhD,CAAJ,EAA0D;AACxDJ,MAAAA,QAAQ,CAAC;AACPK,QAAAA,IAAI,EAAEV,aAAa,CAACW,QADb;AAEPC,QAAAA,OAAO,EAAET;AAFF,OAAD,CAAR;AAID;AACF,GAPD;AAQD,CATM;AAWP,OAAO,MAAMU,gBAAgB,GAAG,CAAC;AAAEC,EAAAA,GAAF;AAAOC,EAAAA,IAAP;AAAaC,EAAAA;AAAb,CAAD,KAA2B;AACzD,SAAO,MAAOX,QAAP,IAAoB;AACzBA,IAAAA,QAAQ,CAAC;AACPK,MAAAA,IAAI,EAAEV,aAAa,CAACiB,WADb;AAEPL,MAAAA,OAAO,EAAEE;AAFF,KAAD,CAAR;;AAKA,QAAI;AACF,YAAMf,WAAW,CAAC,SAAD,EAAYe,GAAZ,EAAiBC,IAAI,CAACG,KAAtB,CAAjB;AACD,KAFD,CAEE,OAAOC,GAAP,EAAY;AACZd,MAAAA,QAAQ,CAAC;AACPK,QAAAA,IAAI,EAAET,YAAY,CAACmB,MADZ;AAEPR,QAAAA,OAAO,EAAE;AAAES,UAAAA,KAAK,EAAEF,GAAG,CAACG,QAAJ,CAAaC,IAAb,CAAkBT;AAA3B;AAFF,OAAD,CAAR;AAID;AACF,GAdD;AAeD,CAhBM;AAkBP,OAAO,MAAMU,gBAAgB,GAAG,CAAC;AAAET,EAAAA;AAAF,CAAD,KAAc;AAC5C,SAAO,MAAOV,QAAP,IAAoB;AACzB,QAAI;AACF,YAAMoB,GAAG,GAAG,MAAM3B,UAAU,CAAC,eAAD,EAAkBiB,IAAI,CAACG,KAAvB,CAA5B;AACA,UAAIQ,MAAM,GAAG,EAAb;AAEAD,MAAAA,GAAG,CAACF,IAAJ,CAASI,aAAT,CAAuBC,OAAvB,CAAgCpB,IAAD,IAAU;AACvCA,QAAAA,IAAI,CAACqB,UAAL,CAAgBD,OAAhB,CAAyBE,EAAD,IAAQ;AAC9B,cAAIA,EAAE,CAACrB,GAAH,KAAWM,IAAI,CAACZ,IAAL,CAAUM,GAAzB,EAA8B;AAC5BiB,YAAAA,MAAM,CAACK,IAAP,CAAY,EAAE,GAAGD,EAAL;AAASE,cAAAA,IAAI,EAAExB,IAAI,CAACwB,IAApB;AAA0BC,cAAAA,KAAK,EAAEzB,IAAI,CAACyB;AAAtC,aAAZ;AACD;AACF,SAJD;AAKD,OAND;AAQA5B,MAAAA,QAAQ,CAAC;AACPK,QAAAA,IAAI,EAAEV,aAAa,CAACkC,iBADb;AAEPtB,QAAAA,OAAO,EAAE;AAAEc,UAAAA,MAAF;AAAUS,UAAAA,MAAM,EAAEV,GAAG,CAACF,IAAJ,CAASY;AAA3B;AAFF,OAAD,CAAR;AAID,KAhBD,CAgBE,OAAOhB,GAAP,EAAY;AACZd,MAAAA,QAAQ,CAAC;AACPK,QAAAA,IAAI,EAAET,YAAY,CAACmB,MADZ;AAEPR,QAAAA,OAAO,EAAE;AAAES,UAAAA,KAAK,EAAEF,GAAG,CAACG,QAAJ,CAAaC,IAAb,CAAkBT;AAA3B;AAFF,OAAD,CAAR;AAID;AACF,GAvBD;AAwBD,CAzBM","sourcesContent":["import { getDataAPI, postDataAPI } from \"../../utils/fetchData\";\r\nimport { MESSAGE_TYPES } from \"../types/messageTypes\";\r\nimport { NOTIFY_TYPES } from \"../types/notifyTypes\";\r\n\r\nexport const addUserAction = ({ user, message }) => {\r\n  return async (dispatch) => {\r\n    if (message.users.every((item) => item._id !== user._id)) {\r\n      dispatch({\r\n        type: MESSAGE_TYPES.ADD_USER,\r\n        payload: user,\r\n      });\r\n    }\r\n  };\r\n};\r\n\r\nexport const addMessageAction = ({ msg, auth, socket }) => {\r\n  return async (dispatch) => {\r\n    dispatch({\r\n      type: MESSAGE_TYPES.ADD_MESSAGE,\r\n      payload: msg,\r\n    });\r\n\r\n    try {\r\n      await postDataAPI(\"message\", msg, auth.token);\r\n    } catch (err) {\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: err.response.data.msg },\r\n      });\r\n    }\r\n  };\r\n};\r\n\r\nexport const getConversations = ({ auth }) => {\r\n  return async (dispatch) => {\r\n    try {\r\n      const res = await getDataAPI(\"conversations\", auth.token);\r\n      let newArr = [];\r\n\r\n      res.data.conversations.forEach((item) => {\r\n        item.recipients.forEach((cv) => {\r\n          if (cv._id === auth.user._id) {\r\n            newArr.push({ ...cv, text: item.text, media: item.media });\r\n          }\r\n        });\r\n      });\r\n\r\n      dispatch({\r\n        type: MESSAGE_TYPES.GET_CONVERSATIONS,\r\n        payload: { newArr, result: res.data.result },\r\n      });\r\n    } catch (err) {\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: err.response.data.msg },\r\n      });\r\n    }\r\n  };\r\n};\r\n"]},"metadata":{},"sourceType":"module"}