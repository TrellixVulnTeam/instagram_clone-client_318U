{"ast":null,"code":"import _toConsumableArray from\"C:/Benkia/MERN/instagram-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:/Benkia/MERN/instagram-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"C:/Benkia/MERN/instagram-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"C:/Benkia/MERN/instagram-clone/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{getDataAPI,patchDataAPI}from\"../../utils/fetchData\";import{imageUpload}from\"../../utils/imageUpload\";import{AUTH_TYPES}from\"../types/authTypes\";import{deleteData}from\"../types/globalTypes\";import{NOTIFY_TYPES}from\"../types/notifyTypes\";import{PROFILE_TYPES}from\"../types/profileTypes\";import{createNewsNotify,removeNewsNotify}from\"./newsActions\";export var getProfileUsers=function getProfileUsers(_ref){var id=_ref.id,auth=_ref.auth;return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var res,res1,users,userPosts;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch({type:PROFILE_TYPES.GET_ID,payload:id});_context.prev=1;dispatch({type:PROFILE_TYPES.LOADING,payload:true});res=getDataAPI(\"/user/\".concat(id),auth.token);res1=getDataAPI(\"/user_posts/\".concat(id),auth.token);_context.next=7;return res;case 7:users=_context.sent;_context.next=10;return res1;case 10:userPosts=_context.sent;dispatch({type:PROFILE_TYPES.GET_USER,payload:users.data});dispatch({type:PROFILE_TYPES.GET_POSTS,payload:_objectSpread(_objectSpread({},userPosts.data),{},{_id:id,page:2})});dispatch({type:PROFILE_TYPES.LOADING,payload:false});_context.next=19;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](1);dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:_context.t0.response.data.msg}});case 19:case\"end\":return _context.stop();}}},_callee,null,[[1,16]]);}));return function(_x){return _ref2.apply(this,arguments);};}();};export var updateProfileUser=function updateProfileUser(_ref3){var userData=_ref3.userData,avatar=_ref3.avatar,auth=_ref3.auth;return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var media,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(userData.fullname){_context2.next=2;break;}return _context2.abrupt(\"return\",dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:\"Please add your full name\"}}));case 2:if(!(userData.fullname.length>25)){_context2.next=4;break;}return _context2.abrupt(\"return\",dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:\"Your full name is too long\"}}));case 4:if(!(userData.story.length>200)){_context2.next=6;break;}return _context2.abrupt(\"return\",dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:\"Your story is too long\"}}));case 6:_context2.prev=6;dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{loading:true}});if(!avatar){_context2.next=12;break;}_context2.next=11;return imageUpload([avatar]);case 11:media=_context2.sent;case 12:_context2.next=14;return patchDataAPI(\"user\",_objectSpread(_objectSpread({},userData),{},{avatar:avatar?media[0].url:auth.user.avatar}),auth.token);case 14:res=_context2.sent;dispatch({type:AUTH_TYPES.AUTH,payload:_objectSpread(_objectSpread({},auth),{},{user:_objectSpread(_objectSpread(_objectSpread({},auth.user),userData),{},{avatar:avatar?media[0].url:auth.user.avatar})})});dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{success:res.data.msg}});_context2.next=22;break;case 19:_context2.prev=19;_context2.t0=_context2[\"catch\"](6);dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:_context2.t0.response.data.msg}});case 22:case\"end\":return _context2.stop();}}},_callee2,null,[[6,19]]);}));return function(_x2){return _ref4.apply(this,arguments);};}();};export var changePasswordUser=function changePasswordUser(_ref5){var userData=_ref5.userData,auth=_ref5.auth;return/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;dispatch({type:PROFILE_TYPES.LOADING,payload:true});_context3.next=4;return patchDataAPI(\"changePassword\",userData,auth.token);case 4:res=_context3.sent;dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{success:res.data.msg}});_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](0);dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:_context3.t0.response.data.msg}});case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[0,8]]);}));return function(_x3){return _ref6.apply(this,arguments);};}();};export var followAction=function followAction(_ref7){var users=_ref7.users,user=_ref7.user,auth=_ref7.auth,socket=_ref7.socket;return/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var newUser,res,msg;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(users.every(function(item){return item._id!==user.id;})){newUser=_objectSpread(_objectSpread({},user),{},{followers:[].concat(_toConsumableArray(user.followers),[auth.user])});}else{users.forEach(function(item){if(item._id===user._id){newUser=_objectSpread(_objectSpread({},item),{},{followers:[].concat(_toConsumableArray(item.followers),[auth.user])});}});}dispatch({type:PROFILE_TYPES.FOLLOW,payload:newUser});dispatch({type:AUTH_TYPES.AUTH,payload:_objectSpread(_objectSpread({},auth),{},{user:_objectSpread(_objectSpread({},auth.user),{},{following:[].concat(_toConsumableArray(auth.user.following),[newUser])})})});_context4.prev=3;_context4.next=6;return patchDataAPI(\"user/\".concat(user._id,\"/follow\"),null,auth.token);case 6:res=_context4.sent;socket.emit(\"follow\",res.data.newUser);//Notify\nmsg={id:auth.user._id,text:\"has started to follow you.\",recipients:[newUser._id],url:\"/profile/\".concat(auth.user._id)};dispatch(createNewsNotify({msg:msg,auth:auth,socket:socket}));_context4.next=15;break;case 12:_context4.prev=12;_context4.t0=_context4[\"catch\"](3);dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:_context4.t0.response.data.msg}});case 15:case\"end\":return _context4.stop();}}},_callee4,null,[[3,12]]);}));return function(_x4){return _ref8.apply(this,arguments);};}();};export var unFollowAction=function unFollowAction(_ref9){var users=_ref9.users,user=_ref9.user,auth=_ref9.auth,socket=_ref9.socket;return/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch){var newUser,res,msg;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(users.every(function(item){return item._id!==user.id;})){newUser=_objectSpread(_objectSpread({},user),{},{followers:deleteData(user.followers,auth.user._id)});}else{users.forEach(function(item){if(item._id===user._id){newUser=_objectSpread(_objectSpread({},item),{},{followers:deleteData(item.followers,auth.user._id)});}});}dispatch({type:PROFILE_TYPES.UNFOLLOW,payload:newUser});dispatch({type:AUTH_TYPES.AUTH,payload:_objectSpread(_objectSpread({},auth),{},{user:_objectSpread(_objectSpread({},auth.user),{},{following:deleteData(auth.user.following,newUser._id)})})});_context5.prev=3;_context5.next=6;return patchDataAPI(\"user/\".concat(user._id,\"/unfollow\"),null,auth.token);case 6:res=_context5.sent;socket.emit(\"unFollow\",res.data.newUser);//Notify\nmsg={id:auth.user._id,text:\"has started to follow you.\",recipients:[newUser._id],url:\"/profile/\".concat(auth.user._id)};dispatch(removeNewsNotify({msg:msg,auth:auth,socket:socket}));_context5.next=15;break;case 12:_context5.prev=12;_context5.t0=_context5[\"catch\"](3);dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:_context5.t0.response.data.msg}});case 15:case\"end\":return _context5.stop();}}},_callee5,null,[[3,12]]);}));return function(_x5){return _ref10.apply(this,arguments);};}();};export var getMoreUserPosts=function getMoreUserPosts(_ref11){var id=_ref11.id,page=_ref11.page,auth=_ref11.auth;return/*#__PURE__*/function(){var _ref12=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(dispatch){var res,newData;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return getDataAPI(\"user_posts/\".concat(id,\"?limit=\").concat(page*9),auth.token);case 3:res=_context6.sent;newData=_objectSpread(_objectSpread({},res.data),{},{page:page+1,_id:id});dispatch({type:PROFILE_TYPES.UPDATE_POST,payload:newData});_context6.next=11;break;case 8:_context6.prev=8;_context6.t0=_context6[\"catch\"](0);dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:_context6.t0.response.data.msg}});case 11:case\"end\":return _context6.stop();}}},_callee6,null,[[0,8]]);}));return function(_x6){return _ref12.apply(this,arguments);};}();};export var getPostAuthAction=function getPostAuthAction(_ref13){var id=_ref13.id,auth=_ref13.auth;return/*#__PURE__*/function(){var _ref14=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(dispatch){var res;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.prev=0;dispatch({type:PROFILE_TYPES.LOADING,payload:true});_context7.next=4;return getDataAPI(\"/user_posts/\".concat(id),auth.token);case 4:res=_context7.sent;dispatch({type:PROFILE_TYPES.GET_POSTS,payload:_objectSpread(_objectSpread({},res.data),{},{_id:id,page:2})});dispatch({type:PROFILE_TYPES.LOADING,payload:false});_context7.next=12;break;case 9:_context7.prev=9;_context7.t0=_context7[\"catch\"](0);dispatch({type:NOTIFY_TYPES.NOTIFY,payload:{error:_context7.t0.response.data.msg}});case 12:case\"end\":return _context7.stop();}}},_callee7,null,[[0,9]]);}));return function(_x7){return _ref14.apply(this,arguments);};}();};","map":{"version":3,"sources":["C:/Benkia/MERN/instagram-clone/client/src/redux/actions/profileActions.js"],"names":["getDataAPI","patchDataAPI","imageUpload","AUTH_TYPES","deleteData","NOTIFY_TYPES","PROFILE_TYPES","createNewsNotify","removeNewsNotify","getProfileUsers","id","auth","dispatch","type","GET_ID","payload","LOADING","res","token","res1","users","userPosts","GET_USER","data","GET_POSTS","_id","page","NOTIFY","error","response","msg","updateProfileUser","userData","avatar","fullname","length","story","loading","media","url","user","AUTH","success","changePasswordUser","followAction","socket","every","item","newUser","followers","forEach","FOLLOW","following","emit","text","recipients","unFollowAction","UNFOLLOW","getMoreUserPosts","newData","UPDATE_POST","getPostAuthAction"],"mappings":"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","sourcesContent":["import { getDataAPI, patchDataAPI } from \"../../utils/fetchData\";\r\nimport { imageUpload } from \"../../utils/imageUpload\";\r\nimport { AUTH_TYPES } from \"../types/authTypes\";\r\nimport { deleteData } from \"../types/globalTypes\";\r\nimport { NOTIFY_TYPES } from \"../types/notifyTypes\";\r\nimport { PROFILE_TYPES } from \"../types/profileTypes\";\r\nimport { createNewsNotify, removeNewsNotify } from \"./newsActions\";\r\n\r\nexport const getProfileUsers = ({ id, auth }) => {\r\n  return async (dispatch) => {\r\n    dispatch({\r\n      type: PROFILE_TYPES.GET_ID,\r\n      payload: id,\r\n    });\r\n\r\n    try {\r\n      dispatch({\r\n        type: PROFILE_TYPES.LOADING,\r\n        payload: true,\r\n      });\r\n      const res = getDataAPI(`/user/${id}`, auth.token);\r\n\r\n      const res1 = getDataAPI(`/user_posts/${id}`, auth.token);\r\n\r\n      const users = await res;\r\n      const userPosts = await res1;\r\n\r\n      dispatch({\r\n        type: PROFILE_TYPES.GET_USER,\r\n        payload: users.data,\r\n      });\r\n\r\n      dispatch({\r\n        type: PROFILE_TYPES.GET_POSTS,\r\n        payload: { ...userPosts.data, _id: id, page: 2 },\r\n      });\r\n\r\n      dispatch({\r\n        type: PROFILE_TYPES.LOADING,\r\n        payload: false,\r\n      });\r\n    } catch (err) {\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: err.response.data.msg },\r\n      });\r\n    }\r\n  };\r\n};\r\n\r\nexport const updateProfileUser =\r\n  ({ userData, avatar, auth }) =>\r\n  async (dispatch) => {\r\n    if (!userData.fullname)\r\n      return dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: \"Please add your full name\" },\r\n      });\r\n    if (userData.fullname.length > 25)\r\n      return dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: \"Your full name is too long\" },\r\n      });\r\n    if (userData.story.length > 200)\r\n      return dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: \"Your story is too long\" },\r\n      });\r\n    try {\r\n      let media;\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { loading: true },\r\n      });\r\n      if (avatar) media = await imageUpload([avatar]);\r\n\r\n      const res = await patchDataAPI(\r\n        \"user\",\r\n        {\r\n          ...userData,\r\n          avatar: avatar ? media[0].url : auth.user.avatar,\r\n        },\r\n        auth.token\r\n      );\r\n\r\n      dispatch({\r\n        type: AUTH_TYPES.AUTH,\r\n        payload: {\r\n          ...auth,\r\n          user: {\r\n            ...auth.user,\r\n            ...userData,\r\n            avatar: avatar ? media[0].url : auth.user.avatar,\r\n          },\r\n        },\r\n      });\r\n\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { success: res.data.msg },\r\n      });\r\n    } catch (err) {\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: err.response.data.msg },\r\n      });\r\n    }\r\n  };\r\n\r\nexport const changePasswordUser = ({ userData, auth }) => {\r\n  return async (dispatch) => {\r\n    try {\r\n      dispatch({\r\n        type: PROFILE_TYPES.LOADING,\r\n        payload: true,\r\n      });\r\n      const res = await patchDataAPI(\"changePassword\", userData, auth.token);\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { success: res.data.msg },\r\n      });\r\n    } catch (err) {\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: err.response.data.msg },\r\n      });\r\n    }\r\n  };\r\n};\r\n\r\nexport const followAction = ({ users, user, auth, socket }) => {\r\n  return async (dispatch) => {\r\n    let newUser;\r\n\r\n    if (users.every((item) => item._id !== user.id)) {\r\n      newUser = { ...user, followers: [...user.followers, auth.user] };\r\n    } else {\r\n      users.forEach((item) => {\r\n        if (item._id === user._id) {\r\n          newUser = { ...item, followers: [...item.followers, auth.user] };\r\n        }\r\n      });\r\n    }\r\n\r\n    dispatch({\r\n      type: PROFILE_TYPES.FOLLOW,\r\n      payload: newUser,\r\n    });\r\n\r\n    dispatch({\r\n      type: AUTH_TYPES.AUTH,\r\n      payload: {\r\n        ...auth,\r\n        user: { ...auth.user, following: [...auth.user.following, newUser] },\r\n      },\r\n    });\r\n\r\n    try {\r\n      const res = await patchDataAPI(\r\n        `user/${user._id}/follow`,\r\n        null,\r\n        auth.token\r\n      );\r\n      socket.emit(\"follow\", res.data.newUser);\r\n\r\n      //Notify\r\n      const msg = {\r\n        id: auth.user._id,\r\n        text: \"has started to follow you.\",\r\n        recipients: [newUser._id],\r\n        url: `/profile/${auth.user._id}`,\r\n      };\r\n\r\n      dispatch(createNewsNotify({ msg, auth, socket }));\r\n    } catch (err) {\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: err.response.data.msg },\r\n      });\r\n    }\r\n  };\r\n};\r\n\r\nexport const unFollowAction = ({ users, user, auth, socket }) => {\r\n  return async (dispatch) => {\r\n    let newUser;\r\n\r\n    if (users.every((item) => item._id !== user.id)) {\r\n      newUser = {\r\n        ...user,\r\n        followers: deleteData(user.followers, auth.user._id),\r\n      };\r\n    } else {\r\n      users.forEach((item) => {\r\n        if (item._id === user._id) {\r\n          newUser = {\r\n            ...item,\r\n            followers: deleteData(item.followers, auth.user._id),\r\n          };\r\n        }\r\n      });\r\n    }\r\n\r\n    dispatch({\r\n      type: PROFILE_TYPES.UNFOLLOW,\r\n      payload: newUser,\r\n    });\r\n\r\n    dispatch({\r\n      type: AUTH_TYPES.AUTH,\r\n      payload: {\r\n        ...auth,\r\n        user: {\r\n          ...auth.user,\r\n          following: deleteData(auth.user.following, newUser._id),\r\n        },\r\n      },\r\n    });\r\n\r\n    try {\r\n      const res = await patchDataAPI(\r\n        `user/${user._id}/unfollow`,\r\n        null,\r\n        auth.token\r\n      );\r\n\r\n      socket.emit(\"unFollow\", res.data.newUser);\r\n\r\n      //Notify\r\n      const msg = {\r\n        id: auth.user._id,\r\n        text: \"has started to follow you.\",\r\n        recipients: [newUser._id],\r\n        url: `/profile/${auth.user._id}`,\r\n      };\r\n\r\n      dispatch(removeNewsNotify({ msg, auth, socket }));\r\n    } catch (err) {\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: err.response.data.msg },\r\n      });\r\n    }\r\n  };\r\n};\r\n\r\nexport const getMoreUserPosts = ({ id, page, auth }) => {\r\n  return async (dispatch) => {\r\n    try {\r\n      const res = await getDataAPI(\r\n        `user_posts/${id}?limit=${page * 9}`,\r\n        auth.token\r\n      );\r\n      const newData = { ...res.data, page: page + 1, _id: id };\r\n      dispatch({\r\n        type: PROFILE_TYPES.UPDATE_POST,\r\n        payload: newData,\r\n      });\r\n    } catch (err) {\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: err.response.data.msg },\r\n      });\r\n    }\r\n  };\r\n};\r\n\r\nexport const getPostAuthAction = ({ id, auth }) => {\r\n  return async (dispatch) => {\r\n    try {\r\n      dispatch({\r\n        type: PROFILE_TYPES.LOADING,\r\n        payload: true,\r\n      });\r\n      const res = await getDataAPI(`/user_posts/${id}`, auth.token);\r\n      dispatch({\r\n        type: PROFILE_TYPES.GET_POSTS,\r\n        payload: { ...res.data, _id: id, page: 2 },\r\n      });\r\n      dispatch({\r\n        type: PROFILE_TYPES.LOADING,\r\n        payload: false,\r\n      });\r\n    } catch (err) {\r\n      dispatch({\r\n        type: NOTIFY_TYPES.NOTIFY,\r\n        payload: { error: err.response.data.msg },\r\n      });\r\n    }\r\n  };\r\n};\r\n"]},"metadata":{},"sourceType":"module"}